# Как обновить приложение на Streamlit

После того как вы внесли изменения в проект, нужно обновить приложение на Streamlit Community Cloud.

## Процесс обновления

### Шаг 1: Проверьте изменения

Посмотрите, какие файлы были изменены:

```powershell
cd D:\projects\DK
git status
```

### Шаг 2: Добавьте изменения в Git

```powershell
# Добавить все измененные файлы
git add .

# Или добавить конкретные файлы
git add src/main.py
git add requirements.txt
# и т.д.
```

### Шаг 3: Создайте коммит

```powershell
git commit -m "Описание изменений"
```

**Примеры хороших сообщений коммита:**
- `"Исправлена ошибка в фильтрах"`
- `"Добавлена новая функция поиска"`
- `"Обновлен Template.xml"`
- `"Исправлена ошибка отображения контролей"`

### Шаг 4: Загрузите изменения на GitHub

```powershell
git push
```

Или если это первый push в новой ветке:
```powershell
git push -u origin main
```

### Шаг 5: Streamlit автоматически обновит приложение

**Важно:** Streamlit Community Cloud автоматически обнаруживает изменения в репозитории и перезапускает приложение!

- Обычно обновление происходит в течение **1-2 минут**
- Вы увидите статус "Updating..." на странице приложения
- После обновления приложение будет доступно с новыми изменениями

---

## Проверка обновления

### На странице приложения Streamlit:

1. Зайдите на https://share.streamlit.io/
2. Откройте ваше приложение
3. В правом верхнем углу нажмите на меню (три точки)
4. Выберите "Manage app"
5. Вы увидите статус:
   - **"Running"** - приложение работает
   - **"Updating..."** - идет обновление
   - **"Error"** - ошибка (нужно проверить логи)

### В логах приложения:

1. На странице управления приложением
2. Вкладка "Logs"
3. Там будут видны все сообщения и ошибки

---

## Быстрая команда для обновления

Создайте файл `update.ps1` для быстрого обновления:

```powershell
# update.ps1
cd D:\projects\DK
git add .
git commit -m "Update: $args"
git push
Write-Host "Изменения загружены. Streamlit обновит приложение автоматически через 1-2 минуты."
```

Использование:
```powershell
.\update.ps1 "Исправлена ошибка в фильтрах"
```

---

## Если изменения не применяются

### 1. Проверьте, что изменения загружены на GitHub

Зайдите на https://github.com/allegimail-commits/controls и убедитесь, что последний коммит виден.

### 2. Принудительно перезапустите приложение

1. Зайдите на https://share.streamlit.io/
2. Откройте ваше приложение
3. Меню (три точки) → "Manage app"
4. Нажмите "Reboot app"

### 3. Проверьте логи на ошибки

1. "Manage app" → "Logs"
2. Ищите ошибки (красным цветом)
3. Исправьте ошибки и повторите процесс

### 4. Проверьте, что файл main.py правильный

Убедитесь, что в настройках приложения указан правильный путь:
- **Main file path:** `src/main.py`

---

## Частые случаи

### Обновили Template.xml

```powershell
git add Template.xml
git commit -m "Обновлен Template.xml"
git push
```

Streamlit автоматически перезагрузит данные при следующем запуске.

### Изменили зависимости (requirements.txt)

```powershell
git add requirements.txt
git commit -m "Обновлены зависимости"
git push
```

Streamlit автоматически переустановит пакеты.

### Изменили код приложения

```powershell
git add src/
git commit -m "Обновлен функционал приложения"
git push
```

Streamlit автоматически перезапустит приложение с новым кодом.

---

## Рекомендации

1. **Делайте коммиты часто** - так проще отслеживать изменения
2. **Используйте понятные сообщения коммита** - это поможет понять историю изменений
3. **Проверяйте логи** - если что-то не работает, логи покажут проблему
4. **Тестируйте локально** - перед загрузкой на GitHub проверьте, что все работает локально:
   ```powershell
   python run.py
   ```

---

## Полный процесс (кратко)

```powershell
# 1. Внесите изменения в код
# 2. Проверьте локально
python run.py

# 3. Добавьте изменения
cd D:\projects\DK
git add .

# 4. Создайте коммит
git commit -m "Описание изменений"

# 5. Загрузите на GitHub
git push

# 6. Streamlit обновит приложение автоматически через 1-2 минуты
```

---

**Готово!** Теперь вы знаете, как обновлять приложение. Просто загружайте изменения на GitHub, и Streamlit сделает все остальное автоматически.



